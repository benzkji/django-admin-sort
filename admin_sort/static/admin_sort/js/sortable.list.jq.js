var SortableList=function(a){'use strict';function b(){a("#result_list").addClass("sortable-list"),t=a(".results"),u=a("#result_list tbody"),s=a("#admin-sort-reorder-link"),0<u.length&&(q=u[0],r=a(".row1, .row2",u).each(c),m=new Sortable(q,{draggable:".draggable-item",handle:".admin-sort-drag",ghostClass:"admin-sort-ghost",chosenClass:"admin-sort-chosen",onUpdate:e}),s.off().on("click",f))}function c(b){var c=this;return c.$=a(this),c.$drag=a(".admin-sort-drag",c.$),c.$.addClass("draggable-item"),c._opts={index:b,pk:c.$drag.data("pk")},c}function d(a){return this._opts.index=a,this.$.removeClass("row1 row2"),this.$.addClass(0==a%2?"row1":"row2"),this}function e(b){if(b.oldIndex!=b.newIndex){var c=b.item,e=b.newIndex,f=a(".draggable-item",u),k={obj:c._opts.pk,csrfmiddlewaretoken:j};0===e?(k.position="left",k.target=f[1]._opts.pk):(k.position="right",k.target=f[e-1]._opts.pk),g(l.sorting),a.ajax({url:p,type:"POST",data:k}).fail(function(){i("there has been a problem sorting the items")}).done(function(b){r=a(".draggable-item",u),r.each(d),"error"===b.message&&i(b.error),h()})}}function f(b){b&&b.preventDefault();var c={csrfmiddlewaretoken:j};g(l.reordering),a.ajax({url:o,type:"POST",data:c}).fail(function(){i("there has been a problem reordering the items")}).done(function(a){t,"error"===a.message&&i(a.error),h(),window.location.reload(!1)})}function g(a){w.html("<span class=\"msg\">"+a+"</span><span class=\"admin-sort-loader\"><span class=\"admin-sort-loader-inner\"></span></span>"),t.append(w)}function h(){w.remove()}function i(a){console.error(a)}var j,k,l,m,n,o,p,q,r,s,t,u,v=a(document),w=a("<div id=\"admin-sort-state\" class=\"admin-sort-state\">"+l+"</div>");return v.ready(b),{options:function(a){j=a.csrf,k=a.pages.current,n=a.pages.total,p=a.urls.update,o=a.urls.reorder,l=a.messages}}}(django.jQuery);